<html>
<head>
    <title>SQLite Ext</title
<?
// NOTE: BLOB data does not work
// NOTE: This example requires the sqlite3 extension

const Sqlite3 = include('sqlite3');

const db = Sqlite3.open(':memory:');

db.exec('CREATE TABLE IF NOT EXISTS items (id INTEGER PRIMARY KEY, name TEXT, data BLOB)');

db.exec('INSERT INTO items (name, data) VALUES (?, ?)', [
    'alpha',
    Sqlite3.blob(new TextEncoder().encode('hello world')),
]);

db.exec('INSERT INTO items (name, data) VALUES (:name, :data)', {
    name: 'bravo',
    data: Sqlite3.blob('bravo-bytes', 'utf8'),
});

const rows = db.query('SELECT id, name, data FROM items ORDER BY id');
const human = rows.rows.map(r => ({
    id: r.id,
    name: r.name,
    data_text: Sqlite3.toText(r.data),
    data_len: r.data.length,
}));
?>
</head>
<body>
<h1>SQLite Ext</h1>
<p>Version: <?= Sqlite3.version() ?></p>
<p>Changes: <?= db.changes ?></p>
<p>Last insert id: <?= db.lastInsertRowId ?></p>
<pre><?= JSON.stringify(human, null, 2) ?></pre>

<? db.close(); ?>
</body>
</html>
